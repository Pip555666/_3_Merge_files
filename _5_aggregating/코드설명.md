# ê³µí¬-íƒìš• ì§€ìˆ˜ ë¶„ì„ ì½”ë“œ

## 1ï¸âƒ£ ê°œìš” ğŸ§

ì´ ì½”ë“œëŠ” ê¸°ì—…ë³„ ê³µí¬-íƒìš• ì§€ìˆ˜(Fear & Greed Index) ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. íŠ¹ì • ê¸°ì—… ë°ì´í„°ë¥¼ ì„ íƒí•´ ğŸ“Š ë¶„ì„í•˜ê³ , CSV íŒŒì¼ë¡œ ì €ì¥í•˜ë©° ê·¸ë˜í”„ê¹Œì§€ ìƒì„±í•©ë‹ˆë‹¤.

### âœ… ë¶„ì„ ê¸°ëŠ¥:

- ì‹œê°„ë³„(hourly), ì›”ë³„(monthly) ê³µí¬-íƒìš• ì§€ìˆ˜ ê³„ì‚°
- ê³µí¬-íƒìš• ì§€ìˆ˜ ë³€í™”ìœ¨(change rate) ë¶„ì„
- ğŸ“ˆ ì´ë™ í‰ê· (7ì¼, 30ì¼) ë¶„ì„ (ì£¼ì„ ì²˜ë¦¬ë¨)
- ğŸ” K-Means í´ëŸ¬ìŠ¤í„°ë§ (ì£¼ì„ ì²˜ë¦¬ë¨)
- ì‹œê°í™” ê·¸ë˜í”„ ìƒì„± ë° ì €ì¥

## 2ï¸âƒ£ ì‹¤í–‰ ë°©ë²• ğŸš€

ì›í•˜ëŠ” ê¸°ì—…ì„ ì„ íƒí•´ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

```bash
python aggregate.py --stock samsung
```

ğŸ¯ ê°€ëŠ¥í•œ ê¸°ì—…: `samsung`, `apple`, `nvidia`, `skhynix`

```bash
python aggregate.py --stock apple
```

ë§Œì•½ `--stock`ì„ ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ `samsung` ë°ì´í„°ê°€ ë¶„ì„ë©ë‹ˆë‹¤.

## 3ï¸âƒ£ ì½”ë“œ ìƒì„¸ ì„¤ëª… ğŸ› 

### ğŸ“‚ 3.1. `setup()` - ê²°ê³¼ ì €ì¥ í´ë” ìƒì„±

```python
def setup(output_dir="_5_aggregating/chart"):
```

- Matplotlib í•œê¸€ í°íŠ¸ ì„¤ì • ğŸ¨ (Malgun Gothic)
- ë¶„ì„ ê²°ê³¼ ì €ì¥ í´ë”ë¥¼ ìƒì„± ğŸ—‚ (`_5_aggregating/chart`)
- ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìë™ ìƒì„± (`os.makedirs()`)

### ğŸ“¥ 3.2. `load_and_preprocess()` - ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì „ì²˜ë¦¬

```python
def load_and_preprocess(file_path, data_dir="_0_data/_3_predict"):
```

- CSV íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ ì‹œê°„ ë°ì´í„° ë³€í™˜ â³
- `time`ì„ `date`(ë‚ ì§œ), `hour`(ì‹œê°„), `year`(ë…„ë„), `month`(ì›”)ë¡œ ë¶„ë¦¬
- `prob_greed` ì»¬ëŸ¼ì„ 100ë°°ë¡œ ë³€í™˜í•´ ê³µí¬íƒìš•ì§€ìˆ˜ ê³„ì‚°

### ğŸ“Š 3.3. `calculate_fear_greed()` - ê³µí¬íƒìš•ì§€ìˆ˜ í‰ê·  ê³„ì‚°

```python
def calculate_fear_greed(df, company, chart_dir):
```

- ì‹œê°„ë³„, ì›”ë³„ ê³µí¬íƒìš•ì§€ìˆ˜ í‰ê·  ê³„ì‚°
- CSV íŒŒì¼ë¡œ ì €ì¥ (hourly, monthly ë°ì´í„°)

### ğŸ“ˆ 3.4. `calculate_change_rate()` - ë³€í™”ìœ¨ ë¶„ì„

```python
def calculate_change_rate(df, company, chart_dir):
```

- ì „ë…„ë„ ëŒ€ë¹„ ë³€í™”ìœ¨(diff) ê³„ì‚°
- ì—°ë„(year), ì‹œê°„(hour) ê¸°ì¤€ìœ¼ë¡œ í‰ê·  ë³€í™”ìœ¨ ì €ì¥
- CSV íŒŒì¼ë¡œ ì €ì¥

### ğŸ“‰ 3.5. `calculate_moving_average()` - ì´ë™ í‰ê·  ë¶„ì„ (ì£¼ì„ ì²˜ë¦¬)

```python
# âœ… ì´ë™ í‰ê·  ë¶„ì„ í•¨ìˆ˜ (ì£¼ì„ ì²˜ë¦¬)
def calculate_moving_average(df_monthly, company, chart_dir):
```

- 7ì¼(ë‹¨ê¸°), 30ì¼(ì¥ê¸°) ì´ë™ í‰ê·  ê³„ì‚°
- ê³¨ë“ í¬ë¡œìŠ¤/ë°ë“œí¬ë¡œìŠ¤ ê°ì§€ ê°€ëŠ¥
- CSV íŒŒì¼ ì €ì¥
- âŒ ê¸°ë³¸ì ìœ¼ë¡œ ì£¼ì„ ì²˜ë¦¬ë¨ (í•„ìš”í•˜ë©´ í™œì„±í™” ê°€ëŠ¥)

### ğŸ¯ 3.6. `cluster_analysis()` - í´ëŸ¬ìŠ¤í„°ë§ (ì£¼ì„ ì²˜ë¦¬)

```python
# âœ… í´ëŸ¬ìŠ¤í„° ë¶„ì„ í•¨ìˆ˜ (ì£¼ì„ ì²˜ë¦¬ ìœ ì§€)
def cluster_analysis(df_monthly, company, chart_dir, n_clusters=3):
```

- K-Means í´ëŸ¬ìŠ¤í„°ë§ í™œìš©
- ê³µí¬íƒìš•ì§€ìˆ˜ë¥¼ 3ê°œì˜ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¥˜
- ğŸ“¢ ë°ì´í„°ê°€ 3ê°œ ë¯¸ë§Œì´ë©´ í´ëŸ¬ìŠ¤í„°ë§ ìˆ˜í–‰ ë¶ˆê°€
- âŒ ê¸°ë³¸ì ìœ¼ë¡œ ì£¼ì„ ì²˜ë¦¬ë¨ (í•„ìš”í•˜ë©´ í™œì„±í™” ê°€ëŠ¥)

### ğŸ–¼ï¸ 3.7. `save_plots()` - ê·¸ë˜í”„ ì €ì¥

```python
def save_plots(df_change_rate, df_monthly, company, chart_dir):
```

- ì—°ë„ë³„ ê³µí¬íƒìš•ì§€ìˆ˜ ë³€í™”ìœ¨ ê·¸ë˜í”„ (change rate)
- ì›”ë³„ í‰ê·  ê³µí¬íƒìš•ì§€ìˆ˜ ê·¸ë˜í”„ (monthly score)
- PNG íŒŒì¼ë¡œ ì €ì¥

### ğŸ”„ 3.8. `main()` - ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜

```python
def main():
    chart_dir = setup()
    file_path = f"{company}_predict_bert.csv"
    df = load_and_preprocess(file_path)
    df_monthly = calculate_fear_greed(df, company, chart_dir)
    df_change_rate = calculate_change_rate(df, company, chart_dir)
    # df_monthly = calculate_moving_average(df_monthly, company, chart_dir)
    # df_monthly = cluster_analysis(df_monthly, company, chart_dir)
    save_plots(df_change_rate, df_monthly, company, chart_dir)
```

- `setup()`ìœ¼ë¡œ ê²°ê³¼ ì €ì¥ í´ë” ìƒì„±
- `--stock` ì¸ìë¡œ ë°›ì€ ê¸°ì—… ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
- ê³µí¬íƒìš•ì§€ìˆ˜ ë¶„ì„ & ë³€í™”ìœ¨ ê³„ì‚°
- (í•„ìš” ì‹œ) ì´ë™í‰ê·  & í´ëŸ¬ìŠ¤í„°ë§ ì‹¤í–‰ ê°€ëŠ¥
- ê·¸ë˜í”„ ì €ì¥

